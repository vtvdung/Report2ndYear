---
title: "MSE"
author: "Dung Vu Tien Viet"
date: "31 octobre 2018"
output: html_document
---

## 1. General formula of MSE

### 1.1. One hospital 

It is characterized by four parameters $(n_c, n_h, p_c, p_h)$ where

* $n_c$ is the number community-acquired infection samples;
* $n_h$ is the number of hospital-acquired infection samples;
* $p_c$ is the prevelance of resistance among community-acquired infections;
* $p_h$ is the prevalence of resistance among hospital-acquired infections.

Our aim is to find the best (in term of MSE) estimator $\hat{p_c}$ of $p_c$.

In absence of information on $n_c$, $n_h$ and $p_h$, the best estimator
of $p_c$ we can get is

$$
\hat{p_c} = \frac{n_c p_c + n_h p_h}{n_c + n_h} \ \ \  (1)
$$
By definition,

$$
\mbox{MSE}\left(\hat{p_c}\right) = \mbox{Var}\left(\hat{p_c}\right) + 
                                   \mbox{Bias}\left(\hat{p_c}\right)^2 =
                 \frac{\hat{p_c} \left(1 - \hat{p_c}\right)} {n_c + n_h} +
                 \left(\hat{p_c} - p_c\right)^2\ \ \ (2)
$$

which gives

$$
\mbox{MSE}\left(\hat{p_c}\right) =
\frac{(n_cp_c+n_hp_h)(n_cq_c+n_hq_h)}{(n_c+n_h)^3} +
\left(\frac{n_hp_h-n_hp_c}{n_c+n_h}\right)^2 \ \ \ (3)
$$
with $q_c = 1 - p_c$ and $q_h = 1 - p_h$.


Divise numerator and denominator of variance and bias by $n_h$


$$
variance = \frac{(\frac{n_c}{n_h}p_c+p_h)(\frac{n_c}{n_h}q_c+q_h)}{(n_c+n_h)(\frac{n_c}{n_h}+1)^2} \ \ \ (4)
$$


$$
bias=\left(\frac{p_h-p_c}{\frac{n_c}{n_h}+1}\right)^2 \ \ \ (5)
$$


$$
lim_{\frac{n_c}{n_h}\to\infty}(variance)=\frac{p_cp_h}{n_c+n_h} \ \ \ (6)
$$

$$
lim_{\frac{n_c}{n_h}\to 0}(variance)=\frac{q_cq_h}{n_c+n_h} \ \ \ (7)
$$


$$
lim_{\frac{n_c}{n_h}\to\infty}(bias) = 0 \ \ \ (8)
$$

$$
lim_{\frac{n_c}{n_h}\to 0}(bias) = (p_h-p_c)^2 \ \ \ (9)
$$

$p_h$ and $p_c$ are constant, so

from (4), (6) and (7) we conclude variance depends on ratio $\frac{n_c}{n_h}$ and value of $n_c,\ n_h$

from (5), (8) and (9) we see that bias depends on ratio $\frac{n_c}{n_h}$ and varies in range $[0, (p_h-p_c)^2]$


**Simulation procedure: validation MSE in case of one hospital**

For a fix value of sample size $n_c$ and $n_h$, I will create a figure two compare MSE obtained by formula and by simulation when $p_c$ and $p_h$ vary.

1. Set value for $p_c$, $p_h$, $n_c$ and $n_h$ 

2. calculate $MSE_f$ using (3).

3. For one simulation loop:

    1. generate two random population using $rbinom(n_c,1,p_c)$ and $rbinom(n_h,1,p_h)$ 

		2. Calculate overall resistance proportion $\left(\hat{p_c}\right)$ after merging two populations 
		
		3. Calculate square of difference bewteen overall resistance $\hat{p_c}$ and $p_c$ --> call $MSE_1$
		
		4. Calculate $MSE_2$, ... $MSE_{10000}$
		
		5. Calculate $MSE_{average} = \frac{\sum_{1 \leqslant i  \leqslant 10000}(MSE)}{10000}$ and compare with $MSE_ obtained by formula_f$

4. Redo from step 1 to step 3 with other value of $p_c$, $p_h$

5. Make a figure of $p_c$ on x axis, $p_h$ on y axis and two lines of $MSE_{average}$ and $MSE_f$

6. $n_c$ and $n_h$ are still constant. Should we choose only some values: 1000, 2000, 10000?
		
*End of simulation procedure*


Verification in case of 1 hospital: I test with multiple values of prevalence in CAI and in HAI

```{r echo=FALSE}

# Simulation MSE for one hospital
# set params
prevalence_c <- seq(0.20,0.50,by=0.1)
prevalence_h <- seq(0.60,0.90,by=0.1)
n_c <- 700
n_h <- 100
MSE_f <- c()
MSE_s <- c()
prev_c <-c()
prev_h <- c()

counter <- 0
for (v1 in prevalence_c){
  for (v2 in prevalence_h){
    counter <- counter+1
    
    p_c <- v1
    q_c <- 1-p_c
    p_h <- v2
    q_h <- 1-p_h
    
    prev_c[counter] <- p_c    
    prev_h[counter] <- p_h
    MSE_f[counter] <- (n_c*p_c+n_h*p_h)*(n_c*q_c+n_h*q_h)/((n_c+n_h)^3) + (n_h*(p_h-p_c)/(n_c+n_h))^2
    
    #pop_c <- rbinom(n_c,1,p_c)
    #pop_h <- rbinom(n_h,1,p_h)
    #pop <- c(pop_c,pop_h)
    SE <- c()
    for (i in 1:1000){
      p_hat <-mean(c(rbinom(n_c,1,p_c),rbinom(n_h,1,p_h))) # overall prevalence
      SE[i] <- (p_hat-p_c)^2
    }
    MSE_s[counter] <- mean(SE)
  }
}

(compare_MSE <- data.frame(prevalence_cai=prev_c,prevalence_hai=prev_h,MSE_formula=MSE_s,MSE_simul=MSE_f,MSEdiff=abs(MSE_s - MSE_f),MSE_diff_percent=round(100*abs(MSE_s - MSE_f)/MSE_f,digits = 1)))

```


### 1.2. In case of $k$ hospitals
Each hospital is characterized by four parameters. 

We suppose the resistance prevalence among CAI ($p_c$) remains constant in all hospitals. 

So the MSE will be represented by a set of parameters $(n_{c1},\dots,n_{ck},n_{h1},\dots,n_{hk},p_c,p_{h1},\dots,p_{hk},)$

$$
\hat{p_c} =\frac{\displaystyle\sum_{1 \leqslant i  \leqslant k}(n_{ci}p_c +n_{hi}p_{hi})}{\displaystyle\sum_{1 \leqslant i  \leqslant k}(n_{ci}+n_{hi})} \ \ \ (10)
$$

And

$$
\mbox{MSE}\left(\hat{p_c}\right) = \frac{\frac{\sum_{}(n_{ci}p_c +n_{hi}p_{hi})}{\sum_{}(n_{ci}+n_{hi})}\left(1-\frac{\sum_{}(n_{ci}p_c +n_{hi}p_{hi})}{\sum_{}(n_{ci}+n_{hi})}\right)}{\sum_{}(n_{ci}+n_{hi})}+\left(\frac{\sum_{}(n_{ci}p_c +n_{hi}p_{hi})}{\sum_{}(n_{ci}+n_{hi})}-p_c\right)^2  \ \ \ (11)
$$


which gives

$$
\mbox{MSE}\left(\hat{p_c}\right) = \frac{\sum_{}(n_{ci}p_c +n_{hi}p_{hi})\sum_{}(n_{ci}q_c +n_{hi}q_{hi})}{(\sum_{}(n_{ci}+n_{hi}))^3} + \left(\frac{\sum_{}n_{hi}(p_{hi}-p_c)}{\sum_{}(n_{ci}+n_{hi})}\right)^2  \ \ \ (12)
$$

```{r echo=FALSE}

# Simulation MSE for two hospitals
# set params

p_c <- 0.3
q_c <- 1-p_c
p_h1 <- 0.5
q_h1 <- 1-p_h1
p_h2 <- 0.7
q_h2 <- 1-p_h2
n_c1 <- 700
n_c2 <- 1000
n_h1 <- 100
n_h2 <- 500

p_f <- (n_c1*p_c+n_h1*p_h1+n_c2*p_c+n_h2*p_h2)/(n_c1+n_h1+n_c2+n_h2)
var_f <- (n_c1*p_c+n_h1*p_h1+n_c2*p_c+n_h2*p_h2)*(n_c1*q_c+n_h1*q_h1+n_c2*q_c+n_h2*q_h2)/((n_c1+n_h1+n_c2+n_h2)^3)
bias2_f <- ((n_h1*(p_h1-p_c)+n_h2*(p_h2-p_c))/(n_c1+n_h1+n_c2+n_h2))^2
MSE_f <- var_f+bias2_f

SE <- c()
loop <- 1000
for (i in 1:loop){
  p_hat <-mean(c(rbinom(n_c1,1,p_c),rbinom(n_h1,1,p_h1),rbinom(n_c2,1,p_c),rbinom(n_h2,1,p_h2))) # overall prevalence
  SE[i] <- (p_hat-p_c)^2
}
MSE_s <- mean(SE)


```
**Validation in case of 2 hospitals**

Validation result using parameter set $(p_c,p_h,n_c,n_h)$ of two hospitals: (`r p_c`, `r p_h1`, `r n_c1`, `r n_h1`) and (`r p_c`, `r p_h2`, `r n_c2`, `r n_h2`)

Using formula (12), estimated p = `r p_f` ; MSE = `r MSE_f`

Using simulation with `r loop` loops, p = `r p_hat`; MSE = `r MSE_s`

MSE difference = `r round(abs(MSE_s - MSE_f),digit=4)`, that corresponds `r round(100*abs(MSE_s - MSE_f)/MSE_f,digits = 1)` percent of MSE obtained by formula.


```{r echo=FALSE}

# Simulation MSE for three hospitals
# set params

p_c <- 0.3
q_c <- 1-p_c
p_h1 <- 0.5
q_h1 <- 1-p_h1
p_h2 <- 0.7
q_h2 <- 1-p_h2
p_h3 <- 0.8
q_h3 <- 1-p_h3

n_c1 <- 700
n_c2 <- 1000
n_c3 <- 600
n_h1 <- 100
n_h2 <- 500
n_h3 <- 100

p_f <- (n_c1*p_c+n_h1*p_h1+n_c2*p_c+n_h2*p_h2+n_c3*p_c+n_h3*p_h3)/(n_c1+n_h1+n_c2+n_h2+n_c3+n_h3)
var_f <- (n_c1*p_c+n_h1*p_h1+n_c2*p_c+n_h2*p_h2+n_c3*p_c+n_h3*p_h3)*(n_c1*q_c+n_h1*q_h1+n_c2*q_c+n_h2*q_h2+n_c3*q_c+n_h3*q_h3)/((n_c1+n_h1+n_c2+n_h2+n_c3+n_h3)^3)
bias2_f <- ((n_h1*(p_h1-p_c)+n_h2*(p_h2-p_c)+n_h3*(p_h3-p_c))/(n_c1+n_h1+n_c2+n_h2+n_c3+n_h3))^2
MSE_f <- var_f+bias2_f

SE <- c()
loop <- 1000
for (i in 1:loop){
  p_hat <-mean(c(rbinom(n_c1,1,p_c),rbinom(n_h1,1,p_h1),rbinom(n_c2,1,p_c),rbinom(n_h2,1,p_h2),rbinom(n_c3,1,p_c),rbinom(n_h3,1,p_h3))) # overall prevalence
  SE[i] <- (p_hat-p_c)^2
}
MSE_s <- mean(SE)


```
**Validation in case of 3 hospitals**

Validation result using parameter set $(p_c,p_h,n_c,n_h)$ of three hospitals: (`r p_c`, `r p_h1`, `r n_c1`, `r n_h1`), (`r p_c`, `r p_h2`, `r n_c2`, `r n_h2`) and (`r p_c`, `r p_h3`, `r n_c3`, `r n_h3`)

Using formula (12), estimated p = `r p_f` ; MSE = `r MSE_f`

Using simulation with `r loop` loops, p = `r p_hat`; MSE = `r MSE_s`

MSE difference = `r round(abs(MSE_s - MSE_f),digit=4)`, that corresponds `r round(100*abs(MSE_s - MSE_f)/MSE_f,digits = 1)` percent of MSE obtained by formula.


## 2. Variation of MSE

We continue to consider following cases:

+ One type of hospital with $t_1$ hospitals

+ Two types of hospital with $t_1$ and $t_2$ hospitals

+ Three types of hospital with $t_1$, $t_2$ and $t_3$ hospitals

Hospitals are considered as same type if they have same parameters.

### 2.1. One type of hospital

Given $t_1$ hospitals having $(n_c,n_h,p_c,p_h),\ q_c=1-p_c,\ q_h=1-p_h$.

$$
MSE=\frac{t_1(n_{c}p_c +n_{h}p_{h})t_1(n_{c}q_c +n_{h}q_{h})}
{(t_1(n_{c}+n_{h}))^3} +
\frac{(t_1(n_{h}(p_{h}-p_c)))^2}
{(t_1(n_{c}+n_{h}))^2}  \ \ \ (13)
$$



$$
MSE=\frac{(n_{c}p_c +n_{h}p_{h})(n_{c}q_c +n_{h}q_{h})}
{t_1(n_{c}+n_{h})^3} +
\frac{n_{h}^2(p_{h}-p_c)^2}
{(n_{c}+n_{h})^2}   \ \ \ (14)
$$


$p_h$ and $p_c$ are constant. Assign $r=\frac{n_c}{n_h}$ and $n=n_c+n_h$

The bias $(\frac{n_{h}^2(p_{h}-p_c)^2}{(n_{c}+n_{h})^2})$ depends on $\frac{n_{h}}{(n_{c}+n_{h})}$ = $\frac{1}{(r+1)}$. $r$ is constant in one hospital (but we do not know the true value). So the bias is constant.

The variance $\frac{(n_{c}p_c +n_{h}p_{h})(n_{c}q_c +n_{h}q_{h})}{t_1(n_{c}+n_{h})^3}$ depends on number of hospital $t_1$ and sample size in one hospital $n$. 

```{r echo=FALSE}

# Simulation MSE for t1 hospitals of same type
# set params

p_c <- 0.3
q_c <- 1-p_c
p_h1 <- 0.5
q_h1 <- 1-p_h1
n_c1 <- 700
n_h1 <- 100
t1 <- 10

p_f <- (t1*n_c1*p_c+t1*n_h1*p_h1)/(t1*n_c1+t1*n_h1)
var_f <- (n_c1*p_c+n_h1*p_h1)*(n_c1*q_c+n_h1*q_h1)/(t1*(n_c1+n_h1)^3)
bias2_f <- (n_h1^2*(p_h1-p_c)^2)/(n_c1+n_h1)^2
MSE_f <- var_f+bias2_f

SE <- c()
loop <- 1000
for (i in 1:loop){
  p_hat <-mean(c(rbinom(t1*n_c1,1,p_c),rbinom(t1*n_h1,1,p_h1))) # overall prevalence
  SE[i] <- (p_hat-p_c)^2
}
MSE_s <- mean(SE)


```



$$
variance=\frac{(rp_c +p_{h})(rq_c +q_{h})}{t_1n(r+1)^2}   \ \ \ (15)
$$

 Thus, the variance depends on number of hospital $t_1$ and sample size in one hospital $n$.

**Validation in case of $t_1$ hospitals of same type**

Validation result using parameter set $(p_c,p_h,n_c,n_h)$ of t1 hospitals: (`r p_c`, `r p_h1`, `r n_c1`, `r n_h1`)

Using formula (14), estimated p = `r p_f` ; MSE = `r MSE_f`

Using simulation with `r loop` loops, p = `r p_hat`; MSE = `r MSE_s`

MSE difference = `r round(abs(MSE_s - MSE_f),digit=4)`, that corresponds `r round(100*abs(MSE_s - MSE_f)/MSE_f,digits = 1)` percent of MSE obtained by formula.



### 2.2. Two types of hospital

Given $t_1$ hospitals having $(n_{c1},n_{h1},p_c,p_{h1}),\ q_c=1-p_c,\ q_{h1}=1-p_{h1}$ and $t_2$ hospitals having $(n_{c2},n_{h2},p_c,p_{h2}),\ q_{h2}=1-p_{h2}$.

$$
MSE=\frac{(t_1(n_{c1}p_c +n_{h1}p_{h1})+t_2(n_{c2}p_c +n_{h2}p_{h2}))(t_1(n_{c1}q_c +n_{h1}q_{h1})+t_2(n_{c2}q_c +n_{h2}q_{h2}))}
{(t_1(n_{c1}+n_{h1})+t_2(n_{c2}+n_{h2}))^3} +
\frac{(t_1n_{h1}(p_{h1}-p_c)+t_2n_{h2}(p_{h2}-p_c))^2}
{(t_1(n_{c1}+n_{h1})+t_2(n_{c2}+n_{h2}))^2}   \ \ \ (16)
$$

```{r echo=FALSE}

# Simulation MSE for t1 and t2 hospitals
# set params

p_c <- 0.3
q_c <- 1-p_c
p_h1 <- 0.5
q_h1 <- 1-p_h1
n_c1 <- 700
n_h1 <- 100
p_h2 <- 0.6
q_h2 <- 1-p_h2
n_c2 <- 800
n_h2 <- 100
t1 <- 8
t2 <- 2

p_f <- (t1*n_c1*p_c+t1*n_h1*p_h1+t2*n_c2*p_c+t2*n_h2*p_h2)/(t1*n_c1+t1*n_h1+t2*n_c2+t2*n_h2)
var_f <- (t1*(n_c1*p_c+n_h1*p_h1)+t2*(n_c2*p_c+n_h2*p_h2))*(t1*(n_c1*q_c+n_h1*q_h1)+t2*(n_c2*q_c+n_h2*q_h2)) / ((t1*(n_c1+n_h1)+t2*(n_c2+n_h2))^3)
bias2_f <- (t1*n_h1*(p_h1-p_c)+t2*n_h2*(p_h2-p_c))^2/(t1*(n_c1+n_h1)+t2*(n_c2+n_h2))^2
MSE_f <- var_f+bias2_f

SE <- c()
loop <- 1000
for (i in 1:loop){
  p_hat <-mean(c(rbinom(t1*n_c1,1,p_c),rbinom(t1*n_h1,1,p_h1),rbinom(t2*n_c2,1,p_c),rbinom(t2*n_h2,1,p_h2))) # overall prevalence
  SE[i] <- (p_hat-p_c)^2
}
MSE_s <- mean(SE)

```

**Validation in case of $t_1$ hospitals of type 1 and $t_2$ hospitals of type 2**

Validation result using parameter set $(p_c,p_h,n_c,n_h)$ of t1 hospitals of type 1 (`r p_c`, `r p_h1`, `r n_c1`, `r n_h1`) and t2 hospitals of type 2 (`r p_c`, `r p_h2`, `r n_c2`, `r n_h2`)

Using formula (14), estimated p = `r p_f` ; MSE = `r MSE_f`

Using simulation with `r loop` loops, p = `r p_hat`; MSE = `r MSE_s`

MSE difference = `r round(abs(MSE_s - MSE_f),digit=4)`, that corresponds `r round(100*abs(MSE_s - MSE_f)/MSE_f,digits = 1)` percent of MSE obtained by formula.



### 2.3. Three types of hospital

Given $t_1$ hospitals having $(n_{c1},n_{h1},p_c,p_{h1}),\ q_c=1-p_c,\ q_{h1}=1-p_{h1}$, $t_2$ hospitals having $(n_{c2},n_{h2},p_c,p_{h2}),\ q_{h2}=1-p_{h2}$ and  $t_3$ hospitals having $(n_{c3},n_{h3},p_c,p_{h3}),\ q_{h3}=1-p_{h3}$.

$$
MSE=\frac{(t_1(n_{c1}p_c +n_{h1}p_{h1})+t_2(n_{c2}p_c +n_{h2}p_{h2})+t_3(n_{c3}p_c +n_{h3}p_{h3}))(t_1(n_{c1}q_c +n_{h1}q_{h1})+t_2(n_{c2}q_c +n_{h2}q_{h2}))+t_3(n_{c3}q_c +n_{h3}q_{h3}))}
{(t_1(n_{c1}+n_{h1})+t_2(n_{c2}+n_{h2})+t_3(n_{c3}+n_{h3}))^3} +
\frac{(t_1n_{h1}(p_{h1}-p_c)+t_2n_{h2}(p_{h2}-p_c)+t_3n_{h3}(p_{h3}-p_c))^2}
{(t_1(n_{c1}+n_{h1})+t_2(n_{c2}+n_{h2})+t_3(n_{c3}+n_{h3}))^2}   \ \ \ (17)
$$


```{r echo=FALSE}

# Simulation MSE for t1, t2 and t3 hospitals
# set params

p_c <- 0.3
q_c <- 1-p_c

p_h1 <- 0.5
q_h1 <- 1-p_h1
n_c1 <- 700
n_h1 <- 100

p_h2 <- 0.6
q_h2 <- 1-p_h2
n_c2 <- 800
n_h2 <- 100

p_h3 <- 0.4
q_h3 <- 1-p_h3
n_c3 <- 600
n_h3 <- 200

t1 <- 8
t2 <- 2
t3 <- 4

p_f <- (t1*n_c1*p_c+t1*n_h1*p_h1+t2*n_c2*p_c+t2*n_h2*p_h2+t3*n_c3*p_c+t3*n_h3*p_h3)/(t1*n_c1+t1*n_h1+t2*n_c2+t2*n_h2+t3*n_c2+t3*n_h3)
var_f <- (t1*(n_c1*p_c+n_h1*p_h1)+t2*(n_c2*p_c+n_h2*p_h2)+t3*(n_c3*p_c+n_h3*p_h3))*(t1*(n_c1*q_c+n_h1*q_h1)+t2*(n_c2*q_c+n_h2*q_h2)+t3*(n_c3*q_c+n_h3*q_h3)) / ((t1*(n_c1+n_h1)+t2*(n_c2+n_h2)+t3*(n_c3+n_h3))^3)
bias2_f <- (t1*n_h1*(p_h1-p_c)+t2*n_h2*(p_h2-p_c)+t3*n_h3*(p_h3-p_c))^2/(t1*(n_c1+n_h1)+t2*(n_c2+n_h2)+t3*(n_c3+n_h3))^2
MSE_f <- var_f+bias2_f

SE <- c()
loop <- 1000
for (i in 1:loop){
  p_hat <-mean(c(rbinom(t1*n_c1,1,p_c),rbinom(t1*n_h1,1,p_h1),rbinom(t2*n_c2,1,p_c),rbinom(t2*n_h2,1,p_h2),rbinom(t3*n_c3,1,p_c),rbinom(t3*n_h3,1,p_h3))) # overall prevalence
  SE[i] <- (p_hat-p_c)^2
}
MSE_s <- mean(SE)

```

**Validation in case of $t_1$ hospitals of type 1, $t_2$ hospitals of type 2 and $t_3$ hospitals of type 3**

Validation result using parameter set $(p_c,p_h,n_c,n_h)$ of t1 hospitals of type 1 (`r p_c`, `r p_h1`, `r n_c1`, `r n_h1`), t2 hospitals of type 2 (`r p_c`, `r p_h2`, `r n_c2`, `r n_h2`) and  t3 hospitals of type 3 (`r p_c`, `r p_h3`, `r n_c3`, `r n_h3`)

Using formula (14), estimated p = `r p_f` ; MSE = `r MSE_f`

Using simulation with `r loop` loops, p = `r p_hat`; MSE = `r MSE_s`

MSE difference = `r round(abs(MSE_s - MSE_f),digit=4)`, that corresponds `r round(100*abs(MSE_s - MSE_f)/MSE_f,digits = 1)` percent of MSE obtained by formula.




### 2.4. Compare bias, variance and MSE between three cases

#### 2.4.1. One type vesus two types of hospital (same number of hospital)

We compare first surveillance system ($t_1+t_2$ hospitals of type 1) and second system ($t_1$ hospitals of type 1 and $t_2$ hospitals of type 2)

Bias comparison

$$
\Delta B=\frac{(t_1n_{h1}(p_{h1}-p_c)+t_2n_{h2}(p_{h2}-p_c))^2}{(t_1(n_{c1}+n_{h1})+t_2(n_{c2}+n_{h2}))^2}-
\frac{n_{h1}^2(p_{h1}-p_c)^2}{(n_{c1}+n_{h1})^2}   \ \ \ (18)
$$

Variance comparison

$$
\Delta V=\frac{(t_1(n_{c1}p_c +n_{h1}p_{h1})+t_2(n_{c2}p_c +n_{h2}p_{h2}))(t_1(n_{c1}q_c +n_{h1}q_{h1})+t_2(n_{c2}q_c +n_{h2}q_{h2}))}
{(t_1(n_{c1}+n_{h1})+t_2(n_{c2}+n_{h2}))^3}-
\frac{(n_{c1}p_c +n_{h1}p_{h1})(n_{c1}q_c +n_{h1}q_{h1})}
{(t_1+t_2)(n_{c1}+n_{h1})^3}   \ \ \ (19)
$$


How $\Delta B$ and $\Delta V$ vary in function of $t_1$ and $t_2$?

